<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Baja — Clean pay</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    :root{ --brand:#1463ff; --text:#0a0a0a; --muted:#6b7280; --border:#e5e7eb; --bg:#fff; }
    *{ box-sizing:border-box } html,body{ height:100% }
    body{ margin:0; font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; color:var(--text); background:var(--bg) }
    a{ color:inherit; text-decoration:none }
    .container{ max-width:1200px; margin:0 auto; padding:0 20px }

    /* NAV (mockup) */
    .nav{height:72px; border-bottom:1px solid var(--border); position:sticky; top:0; background:#fff; z-index:10}
    .nav__inner{display:flex; align-items:center; height:100%}
    .nav__logo{display:flex; align-items:center; gap:10px; margin-right:22px}
    .logo{width:28px; height:28px; border-radius:50%; display:grid; place-items:center; color:#fff; font-weight:800; background:var(--brand)}
    .brand{font-size:1.25rem; font-weight:800}
    .nav__spacer{flex:1}
    .pill{display:inline-block; background:#000; color:#fff; font-weight:900; padding:10px 14px; border-radius:999px; text-decoration:none}

    /* Cabecera azul */
    .head-blue{ background:var(--brand); color:#fff; padding:18px 16px; border-radius:12px; margin:26px 0 16px; }
    .title{ font-size:clamp(34px,5vw,56px); line-height:1.05; font-weight:900; margin:0 }
    .sub{ color:var(--muted); margin:6px 0 14px }

    /* Panel estado */
    .panel{ border:1px solid var(--border); border-radius:16px; background:#fff; padding:22px; display:grid; gap:14px; max-width:720px }
    .status{ padding:12px 14px; border-radius:12px; border:1px solid var(--border); display:none }
    .status.show{ display:block }
    .processing{ background:#f8fafc; position:relative }
    .success{ background:#ecfdf5; border-color:#16a34a }
    .error{ background:#fef2f2; border-color:#dc2626 }

    /* Spinner */
    .spinner{
      width:18px; height:18px; border-radius:50%;
      border:3px solid #d1d5db; border-top-color:var(--brand);
      animation:spin 1s linear infinite; display:inline-block; vertical-align:-4px; margin-right:8px;
    }
    @keyframes spin { to { transform:rotate(360deg) } }

    /* Botones auxiliares (opcional) */
    .actions{ display:flex; gap:10px; }
    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding:10px 14px; border-radius:12px; border:1px solid var(--border);
      background:#000; color:#fff; font-weight:900; cursor:pointer;
    }
    .btn--ghost{ background:#fff; color:#000 }
  </style>
</head>
<body>
  <!-- NAV -->
  <div class="nav">
    <div class="container nav__inner">
      <a class="nav__logo" href="/">
        <div class="logo">B</div>
        <div class="brand">Sabadell Demo</div>
      </a>
      <div class="nav__spacer"></div>
      <a href="/clean-pay.html" class="pill">← Atrás</a>
    </div>
  </div>

  <!-- Contenido -->
  <section>
    <div class="container">
      <div class="head-blue">
        <h1 class="title">Baja</h1>
      </div>
      <p class="sub">Estamos tramitando tu baja. Mantén esta página abierta.</p>

      <div class="panel">
        <!-- Estados -->
        <div id="msgProcessing" class="status processing show">
          <span class="spinner"></span>Se está procesando tu solicitud…
        </div>
        <div id="msgOk" class="status success">Se ha realizado con éxito </div>
        <div id="msgErr" class="status error">Se ha producido un error </div>

        <!-- (Opcional) acciones extra -->
        <div class="actions">
          <button id="btnReintentar" class="btn btn--ghost" style="display:none">Reintentar</button>
          <a href="/clean-pay.html" class="btn btn--ghost" id="btnVolver" style="display:none">Volver</a>
        </div>
      </div>
    </div>
  </section>

  <script>
    const $msgP = document.getElementById('msgProcessing');
    const $msgOk = document.getElementById('msgOk');
    const $msgErr = document.getElementById('msgErr');
    const $btnReint = document.getElementById('btnReintentar');
    const $btnVolver = document.getElementById('btnVolver');

    function showOnly(el){
      [$msgP, $msgOk, $msgErr].forEach(x => x.classList.remove('show'));
      el.classList.add('show');
      // botones
      if (el === $msgErr) {
        $btnReint.style.display = '';
        $btnVolver.style.display = '';
      } else if (el === $msgOk) {
        $btnReint.style.display = 'none';
        $btnVolver.style.display = '';
      } else {
        $btnReint.style.display = 'none';
        $btnVolver.style.display = 'none';
      }
    }

    // Esqueleto: llamada a API al cargar
    async function procesarBaja() {
      try {
        showOnly($msgP);
        const res = await callBajaApi(); // <— tu endpoint real
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        // const data = await res.json().catch(()=> ({})); // si necesitas leer respuesta
        showOnly($msgOk);
      } catch (err) {
        console.error(err);
        showOnly($msgErr);
      }
    }

    // Endpoint de ejemplo—cámbialo por el tuyo
    function callBajaApi(){
      return fetch('https://api.ejemplo.com/baja', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        // body: JSON.stringify({ /* datos si necesitas */ })
        // credentials: 'include', // si necesitas cookies
        // headers: { Authorization: 'Bearer <token>' } // si necesitas token
      });

      // MOCK para pruebas sin backend:
      // return new Promise((resolve, reject) => {
      //   setTimeout(() => {
      //     const ok = true; // cambia a false para simular error
      //     ok ? resolve(new Response('{}', { status: 200 })) :
      //          reject(new Error('Simulado'));
      //   }, 1500);
      // });
    }

    // Reintentar en caso de error
    $btnReint?.addEventListener('click', procesarBaja);

    // Lanza la petición automáticamente al entrar
    window.addEventListener('load', procesarBaja);
  </script>
</body>
</html>
